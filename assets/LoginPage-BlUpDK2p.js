import{r as g,o as B,w as R,u as $,c,a as q,b as w,d as a,e as l,f as _,g as i,h as y,l as x,i as n,j as N,E,k as P}from"./index-CWzDDoqp.js";import{E as z,a as F}from"./el-col-DpQOQ9iO.js";import{E as T,a as j}from"./el-form-item-DdSBbT10.js";import{_ as A,E as D}from"./_plugin-vue_export-helper-CPSEkvkw.js";import{E as G}from"./el-link-C0PFiF-X.js";import{E as H}from"./el-checkbox-GKIYe11S.js";import{E as J}from"./el-input-BaIcVOUt.js";import"./el-message-B3q5BU4e.js";const K={class:"flex"},O={__name:"LoginPage",setup(Q){const m=g(!0),o=g({username:"",password:"",repassword:""});B(()=>{const d=localStorage.getItem("rememberMe"),e=localStorage.getItem("username"),t=localStorage.getItem("password");d==="true"&&(u.value=!0,e&&(o.value.username=e),t&&(o.value.password=t))});const V={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:5,max:10,message:"用户名必须是5-10位的字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码必须是6-15位的非空字符",trigger:"blur"}],repassword:[{required:!0,message:"请再次输入密码",trigger:"blur"},{pattern:/^\S{6,15}$/,message:"密码必须是6-15的非空字符",trigger:"blur"},{validator:(d,e,t)=>{e!==o.value.password?t(new Error("两次输入密码不一致!")):t()},trigger:"blur"}]},f=g(),S=async()=>{await f.value.validate(),await P(o.value),E.success("注册成功"),m.value=!1};R(m,()=>{o.value={username:"",password:"",repassword:""}});const I=$(),u=g(!1),M=q(),U=async()=>{await f.value.validate();const d=await N(o.value);I.setToken(d.token),E.success("登录成功"),u.value?(localStorage.setItem("rememberMe",u.value),localStorage.setItem("username",o.value.username),localStorage.setItem("password",o.value.password)):(localStorage.setItem("rememberMe",u.value),localStorage.removeItem("username"),localStorage.removeItem("password")),M.push("/")};return(d,e)=>{const t=z,r=j,p=J,C=H,v=G,b=D,k=T,L=F;return w(),c(L,{class:"login-page"},{default:a(()=>[l(t,{span:12,class:"bg"}),l(t,{span:6,offset:3,class:"form"},{default:a(()=>[m.value?(w(),c(k,{key:0,model:o.value,rules:V,ref_key:"form",ref:f,size:"large",autocomplete:"off"},{default:a(()=>[l(r,null,{default:a(()=>[...e[8]||(e[8]=[_("h1",null,"登录",-1)])]),_:1}),l(r,{prop:"username"},{default:a(()=>[l(p,{modelValue:o.value.username,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.username=s),"prefix-icon":i(y),placeholder:"请输入用户名"},null,8,["modelValue","prefix-icon"])]),_:1}),l(r,{prop:"password"},{default:a(()=>[l(p,{name:"password",modelValue:o.value.password,"onUpdate:modelValue":e[1]||(e[1]=s=>o.value.password=s),"prefix-icon":i(x),type:"password",placeholder:"请输入密码"},null,8,["modelValue","prefix-icon"])]),_:1}),l(r,{class:"flex"},{default:a(()=>[_("div",K,[l(C,{modelValue:u.value,"onUpdate:modelValue":e[2]||(e[2]=s=>u.value=s)},{default:a(()=>[...e[9]||(e[9]=[n("记住我",-1)])]),_:1},8,["modelValue"]),l(v,{type:"primary",underline:!1},{default:a(()=>[...e[10]||(e[10]=[n("忘记密码？",-1)])]),_:1})])]),_:1}),l(r,null,{default:a(()=>[l(b,{onClick:U,class:"button",type:"primary","auto-insert-space":""},{default:a(()=>[...e[11]||(e[11]=[n("登录",-1)])]),_:1})]),_:1}),l(r,{class:"flex"},{default:a(()=>[l(v,{type:"info",underline:!1,onClick:e[3]||(e[3]=s=>m.value=!1)},{default:a(()=>[...e[12]||(e[12]=[n(" 注册 → ",-1)])]),_:1})]),_:1})]),_:1},8,["model"])):(w(),c(k,{key:1,model:o.value,rules:V,ref_key:"form",ref:f,size:"large",autocomplete:"off"},{default:a(()=>[l(r,null,{default:a(()=>[...e[13]||(e[13]=[_("h1",null,"注册",-1)])]),_:1}),l(r,{prop:"username"},{default:a(()=>[l(p,{modelValue:o.value.username,"onUpdate:modelValue":e[4]||(e[4]=s=>o.value.username=s),"prefix-icon":i(y),placeholder:"请输入用户名"},null,8,["modelValue","prefix-icon"])]),_:1}),l(r,{prop:"password"},{default:a(()=>[l(p,{"prefix-icon":i(x),modelValue:o.value.password,"onUpdate:modelValue":e[5]||(e[5]=s=>o.value.password=s),type:"password",placeholder:"请输入密码"},null,8,["prefix-icon","modelValue"])]),_:1}),l(r,{prop:"repassword"},{default:a(()=>[l(p,{"prefix-icon":i(x),modelValue:o.value.repassword,"onUpdate:modelValue":e[6]||(e[6]=s=>o.value.repassword=s),type:"password",placeholder:"请输入再次密码"},null,8,["prefix-icon","modelValue"])]),_:1}),l(r,null,{default:a(()=>[l(b,{onClick:S,class:"button",type:"primary","auto-insert-space":""},{default:a(()=>[...e[14]||(e[14]=[n(" 注册 ",-1)])]),_:1})]),_:1}),l(r,{class:"flex"},{default:a(()=>[l(v,{type:"info",underline:!1,onClick:e[7]||(e[7]=s=>m.value=!0)},{default:a(()=>[...e[15]||(e[15]=[n(" ← 返回 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"]))]),_:1})]),_:1})}}},oe=A(O,[["__scopeId","data-v-c13cc734"]]);export{oe as default};
